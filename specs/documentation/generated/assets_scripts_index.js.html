<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: assets/scripts/index.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: assets/scripts/index.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import Animator from "./Animator.js";
import * as consts from "./consts.js";
import TarotCard from "./TarotCard.js";

// Div that contains all tarot card page elements
const tarotDiv = document.getElementById("tarotDiv");
// Response texts
const response = document.getElementById("response");
// Global cardCounter variable, moved because couldn't reset the cards. DANGER!
let cardCounter = 0;
// Global variable that shows if 3 cards have been selected
let cardsSelected = false;
// Global homepage varible for checking if on homepage
let homePageBool = true;

// reset flag
let resetFlag = false;

/**
 * Binds the home page buttons to change the type of
 * consts.FORTUNETYPE that is displayed
 * @author Elvis Joa
 * @date 5/21/2023
 */
function bindHomePageBtns() {
	const tarotCardBtn = document.getElementById("toTarotCard");
	const eggBtn = document.getElementById("toEgg");
	const boneBtn = document.getElementById("toBoneTossing");

	/**
     * Added changeBackgroundColor and the mouseOver and mouseOut listeners.
     * @author Kevin Wong
     * @date 5/24/2023
     * @param {string} color - A parameter for what color the background
     * should be.
     */
	function changeBackgroundColor(color) {
		document.body.style.backgroundColor = color;
	}

	tarotCardBtn.addEventListener("click", () => {
		displayGeneralUIElements(consts.FORTUNETYPES.tarotCard);
		tarotDiv.hidden = false;
		document.getElementById("tarotShuffleBtn").hidden = false;
		// addFogBackground();
		homePageBool = false;
	});

	tarotCardBtn.addEventListener("mouseover", () => {
		changeBackgroundColor("red");
	});

	tarotCardBtn.addEventListener("mouseout", () => {
		changeBackgroundColor("black");
	});

	eggBtn.addEventListener("click", () => {
		homePageBool = false;
		console.log(consts.FORTUNETYPES.egg);
		displayGeneralUIElements(consts.FORTUNETYPES.egg);
		document.getElementById("center-text").textContent =
            consts.FORTUNETYPES.egg;
		document.getElementById("response").textContent =
            "THIS IS THE RESPONSE FOR THE EGG";
	});

	eggBtn.addEventListener("mouseover", () => {
		changeBackgroundColor("blue");
	});

	eggBtn.addEventListener("mouseout", () => {
		changeBackgroundColor("black");
	});

	boneBtn.addEventListener("click", () => {
		homePageBool = false;
		console.log(consts.FORTUNETYPES.bone);
		displayGeneralUIElements(consts.FORTUNETYPES.bone);
		document.getElementById("center-text").textContent =
            consts.FORTUNETYPES.bone;
		document.getElementById("response").textContent =
            "THIS IS THE RESPONSE FOR THE BONE TOSSING";
	});


	boneBtn.addEventListener("mouseover", () => {
		changeBackgroundColor("green");
	});

	boneBtn.addEventListener("mouseout", () => {
		changeBackgroundColor("black");
	});
}

/**
 * Binds the buttons that appear at the top left for
 * all consts.FORTUNE telling,
 * more specifically the home, options, and GitHub buttons.
 * @author Elvis Joa
 * @date 5/21/2023
 */
function bindGeneralButtons() {
	// const homeBtn = document.getElementById("toHome");
	// // Added to reset cards on click
	// homeBtn.addEventListener("click", () => {
	// 	if (!homePageBool) {
	// 		displayGeneralUIElements();
	// 		document.getElementById("center-text").textContent = "";
	// 		document.getElementById("response").textContent = "";
	// 		const responseCards =
	// 			document.getElementsByClassName("responseCards");
	// 		while (responseCards.length > 0) {
	// 			tarotDiv.removeChild(responseCards[0]);
	// 		}
	// 		tarotDiv.hidden = true;
	// 		homePageBool = true;
	// 		resetCards();
	// 		removeFogBackground();
	// 	}
	// });

	const docBtn = document.getElementById("toDocumentation");
	const githubBtn = document.getElementById("toGitHub");

	docBtn.addEventListener("click", () => {
		window.open(
			"https://cse110-sp23-group27.github.io/" +
			"Fortune-Telling-Group-27/specs/documentation/generated/index.html"
		);
	});
	githubBtn.addEventListener("click", () => {
		window.open(
			"https://github.com/cse110-sp23-group27/" +
			"Fortune-Telling-Group-27/tree/main"
		);
	});

	// githubBtn.addEventListener("click", () => {
	// 	navigator.clipboard.writeText(
	// 		"https://github.com/cse110-sp23-group27/Fortune-Telling-Group-27");
	// });
}

/**
 * Displays the UI elements that are needed and wanted
 * @author Elvis Joa
 * @date 5/21/2023
 * @param {string} fortuneType - Displays elements for this fortune type
 */
function displayGeneralUIElements(fortuneType =null) {
	// Changes the general buttons (home, options, GitHub)
	const generalBtns = document.getElementsByClassName("general");
	for (let i = 0; i &lt; generalBtns.length; i++) {
		generalBtns[i].hidden = !generalBtns[i].hidden;
	}

	// Hides/Displays the option button that is needed if any
	for (let i = 0; i &lt; 3; i++) {
		const optionsBtn = document.getElementById(
			consts.FORTUNELIST[i]+"Options");
		optionsBtn.hidden = true;
	}
	if (fortuneType != null) {
		const optionsBtn = document.getElementById(fortuneType + "Options");
		optionsBtn.hidden = !optionsBtn.hidden;
	}

	// Hides/Displays the home page buttons as needed
	const homeBtns = document.getElementsByClassName("home-page");
	for (let i = 0; i &lt; homeBtns.length; i++) {
		homeBtns[i].hidden = !homeBtns[i].hidden;
	}
	response.textContent = "";
}

// /**
//  * Creates and displays the shuffle button that should trigger the animation
//  * for the tarot cards.
//  * @authors Elvis Joa, Daniel Lee, and Kevin Wong
//  * @date 5/27/2023
//  */
// function createShuffleBtn() {
// 	const shuffleBtn = document.createElement("button");
// 	shuffleBtn.id = "tarotShuffleBtn";
// 	shuffleBtn.textContent = "SHUFFLE CARDS";
// 	shuffleBtn.addEventListener("click", () => {
// 		shuffleBtn.hidden = true;
// 		const cards = document.getElementsByClassName("cardsBtnPreShuffle");
// 		for (let card = 0; card &lt; cards.length; card++) {
// 			const cardOption = cards[card];
// 			cardOption.hidden = false;
// 		}
// 		playShuffleAnimation(()=>{
// 			playCardSpreadAnimation();
// 		});
// 	});
// 	tarotDiv.append(shuffleBtn);
// }

/**
 * Binds the start button
 * @date 6/6/2023 - 1:59:27 PM
 * @author Victor Kim
 */
function bindStartButton() {
	const startBtn = document.getElementById("tarotStartBtn");
	const resetBtn = document.getElementById("tarotResetBtn");
	startBtn.addEventListener("click", async ()=>{
		resetFlag = false;
		startBtn.hidden = true;
		resetBtn.hidden = false;
		if (resetFlag) {
			return;
		}
		await playCardThrowAnimation();
		if (resetFlag) {
			return;
		}
		await TarotCard.wait(100);
		if (resetFlag) {
			return;
		}
		await playShuffleAnimation();
		if (resetFlag) {
			return;
		}
		playCardSpreadAnimation();
	});
}

/**
 * Binds the shuffle button
 * @date 6/6/2023 - 1:58:55 PM
 * @author Victor Kim
 */
function bindShuffleButton() {
	const shuffleBtn = document.getElementById("tarotShuffleBtn");
	shuffleBtn.addEventListener("click", ()=>{
		shuffleBtn.hidden = true;
		const cards = document.getElementsByClassName("cardsBtnPreShuffle");
		for (let card = 0; card &lt; cards.length; card++) {
			const cardOption = cards[card];
			cardOption.hidden = false;
		}
	});
}

/**
 * Plays the card throw animation
 * @date 6/6/2023 - 1:58:41 PM
 * @author Victor Kim
 *
 * @async
 * @return {None}
 */
async function playCardThrowAnimation() {
	const cards = TarotCard.getAllCards();
	// unhide, move, and make unclickable
	cards.forEach((card) => {
		card.cardElement.hidden = false;
		card.setClickable(false);
		card.moveInstantly(consts.preThrow_card_pos);
	});
	if (resetFlag) {
		return;
	}
	await TarotCard.wait(200);
	if (resetFlag) {
		return;
	}
	await cards[cards.length - 1].movePromise(
		cards[cards.length - 1].getPositionPoint(),
		consts.preThrow_card_pos,
		200
	);
	if (resetFlag) {
		return;
	}
	await TarotCard.wait(100);
	if (resetFlag) {
		return;
	}
	// throw in random directions
	for (let i = 0; i &lt; cards.length - 1; i++) {
		const pos = {
			x: consts.afterThrow_card_X_min +
				Math.random()*consts.afterThrow_card_X_max,
			y: consts.afterThrow_card_Y_min +
				Math.random()*consts.afterThrow_card_Y_max
		};
		const rot = consts.afterThrow_card_Rotation_min +
						Math.random()*consts.afterThrow_card_Rotation_max;
		cards[i].movePromise(cards[i].getPositionPoint(), pos, 200);
		cards[i].rotatePromise(0, rot, 230);
		if (resetFlag) {
			return;
		}
		await TarotCard.wait(50);
	}
	if (resetFlag) {
		return;
	}
	const pos = {
		x: consts.afterThrow_card_X_min +
			Math.random()*consts.afterThrow_card_X_max,
		y: consts.afterThrow_card_Y_min +
			Math.random()*consts.afterThrow_card_Y_max
	};
	const rot = consts.afterThrow_card_Rotation_min +
					Math.random()*consts.afterThrow_card_Rotation_max;
	cards[cards.length - 1].movePromise(
		cards[cards.length - 1].getPositionPoint(),
		pos,
		200
	);
	if (resetFlag) {
		return;
	}
	return cards[cards.length - 1].rotatePromise(0, rot, 230);
}

/**
 * Will play the shuffle animation for the current cards
 * @date 5/29/2023 - 9:20:17 PM
 */
async function playShuffleAnimation() {
	const cards = TarotCard.getAllCards();
	if (resetFlag) {
		return;
	}
	// Move all to center and rotate in to deck
	for (let i = 0; i &lt; cards.length - 1; i++) {
		const card = cards[i];
		card.move(card.getPositionPoint(), consts.shuffle_deck_pos, 200);
		card.rotate(card.getRotation(), 0, 200);
		await TarotCard.wait(50);
		if (resetFlag) {
			return;
		}
	}
	cards[cards.length - 1].move(
		cards[cards.length - 1].getPositionPoint(),
		consts.shuffle_deck_pos,
		200
	);
	await cards[cards.length - 1].rotatePromise(
		cards[cards.length - 1].getRotation(),
		0,
		200
	);
	if (resetFlag) {
		return;
	}

	await TarotCard.wait(350);
	if (resetFlag) {
		return;
	}

	// make 3 shuffles
	for (let i = 0; i &lt; 3; i++) {
		// pick random card
		const randCard = cards[Math.floor(22 * Math.random())];
		// move away
		await randCard.movePromise(
			consts.shuffle_deck_pos,
			consts.shuffle_card_pos,
			350
		);
		if (resetFlag) {
			return;
		}
		const startZIndex = randCard.getZIndex();
		randCard.setZIndex(100 + i);
		// pause
		await TarotCard.wait(30);
		if (resetFlag) {
			return;
		}
		// move back
		await randCard.movePromise(
			consts.shuffle_card_pos,
			consts.shuffle_deck_pos,
			350
		);
		if (resetFlag) {
			return;
		}
		randCard.setZIndex(startZIndex);
		// pause
		await TarotCard.wait(50);
		if (resetFlag) {
			return;
		}
	}
	return TarotCard.wait(350);
}

/**
 * Plays the card spread animation
 * @date 5/29/2023 - 10:18:49 PM
 * @param {Function} callback a callback function for end of animation
 */
function playCardSpreadAnimation() {
	const tCards = TarotCard.getAllCards();
	let cardXoffset = 0;
	if (resetFlag) {
		return;
	}
	tCards.forEach((tCard) => {
		if (resetFlag) {
			return;
		}
		tCard.setClickable(true);
		tCard.move(consts.shuffle_deck_pos,
			{x: 10 + (80/tCards.length)*cardXoffset,
				y: consts.cardY}
			, 300, ()=>{
				tCard.setClickable(true);
			});
		cardXoffset++;
	});
}

/**
 * Creates and displays the tarot cards that are selected. Cards will change
 * in appearance if they are selected. 3 cards have to be selected.
 * @authors Elvis Joa, Daniel Lee, and Kevin Wong
 * @date 5/27/2023
 */
function createShuffleCards() {
	for (let i = 0; i &lt; 22; i++) {
		const button = document.createElement("button");
		button.id = "Option " + i;
		button.className = "cardsBtnPreShuffle";
		button.hidden = true;
		button.innerHTML = "&lt;img class = \"chosenCards\"src=\"" +
			consts.CARD_BACK+"\">";
		button.style.backgroundColor = "white";
		button.setAttribute("selected", false);
		// Change appearance when selected/unselected
		button.addEventListener("click", () =>{
			if (cardsSelected) {
				response.textContent = button.value;
				return;
			}

			if (button.getAttribute("selected") === "true") {
				button.setAttribute("selected", false);
				button.style.backgroundColor = "white";
				cardCounter--;
			} else {
				button.setAttribute("selected", true);
				button.style.backgroundColor = "black";
				cardCounter++;
			}

			if (cardCounter == 3) {
				cardCounter = 0;
				displayThreeOptions();
			}
		});
		tarotDiv.appendChild(button);
		// get all of the cards and make them into the TarotCard classes
		new TarotCard(button);
	}
}

/**
 * After selecting three cards, 3 cards will appear, and from left to right,
 * the cards represent the past, present and future descriptions.
 * @authors Elvis Joa, Daniel Lee, and Kevin Wong
 * @date 5/27/2023
 */
function displayThreeOptions() {
	// get html elements of selected cards
	const selectedHTMLCards = [];
	for (let i = 0; i &lt; 22; i++) {
		const button = document.getElementById(`Option ${i}`);
		if (button.getAttribute("selected") === "true") {
			selectedHTMLCards.push(button);
			button.setAttribute("selected", false);
		}
	}
	cardsSelected = true;

	let selectedCardsFound = 0;
	let cardsMoved = 0;
	TarotCard.getAllCards().forEach((card) => {
		if (selectedHTMLCards.includes(card.cardElement)) {
			console.log(card.getPositionPoint());
			card.move(card.getPositionPoint(),
				{x: 20+(selectedCardsFound*(60/2)), y: 10}, 350);
			selectedCardsFound++;
		} else {
			const curPos = card.getPositionPoint();
			card.move(curPos, {x: curPos.x, y: -100}, 350, ()=>{
				cardsMoved++;
				if (cardsMoved &lt; 3) {
					return;
				}
				const cardsTypeSelected = [];
				while (cardsTypeSelected.length &lt; 3) {
					const card = Math.floor(Math.random()*21);
					if (cardsTypeSelected.indexOf(card) === -1) {
						cardsTypeSelected.push(card);
					}
				}

				for (let i = 2; i >= 0; i--) {
					const cardOption = selectedHTMLCards[i];
					const tarotCard = consts.CARDSJSON[cardsTypeSelected[i]];
					const imageSrc = tarotCard["img"];
					cardOption.innerHTML =
						"&lt;img class = \"chosenCards\"src=\"" +imageSrc+"\"/>";
					switch (i + 1) {
					case 1:
						cardOption.value = tarotCard["pastDescription"];
						break;
					case 2:
						cardOption.value = tarotCard["presentDescription"];
						break;
					default:
						cardOption.value = tarotCard["futureDescription"];
					}

					// TODO: Find a better way to do this,
					// apparently this can cause a memory leak
					// but don't have time to make a better solution rn
					// https://stackoverflow.com/questions/9251837/how-to-remove-all-listeners-in-an-element
					// remove old on click events
					/* cardOption.hidden = true;
					const clonedCardOption = cardOption.cloneNode(true);
					clonedCardOption.className = "responseCards21";
					// const tempCardOption = cardOption;
					cardOption.parentNode.replaceChild(
						clonedCardOption, cardOption);
					// tempCardOption.remove();
					cardOption.hidden = false;
					tarotDiv.appendChild(cardOption);*/
				}
			});
		}
	});
}

/**
 * Function to reset cards on home page press, goes through each
 * card and resets it to default values
 * @authors Kevin Wong
 * @date 5/29/2023
 */
function resetCards() {
	for (let card = 0; card &lt; 22; card++) {
		const cardOption = document.getElementById("Option " + card);
		cardOption.innerHTML =
			"&lt;img class = \"imagesPreShuffle\"src="+consts.CARD_BACK +">";
		if (cardOption) {
			cardOption.setAttribute("selected", false);
			cardOption.style.backgroundColor = "white";
			cardOption.hidden = true;
		}
	}
	cardCounter = 0; // reset the cardCounter when resetting cards
	cardsSelected = false;
}
/**
 * Adds a fog background to the tarot card page
 * @date 5/31/2023
 */
// function addFogBackground() {
// 	const fog = document.createElement("div");
// 	fog.className = "fogwrapper";
// 	fog.innerHTML = `&lt;div id="foglayer_01" class="fog">
// 							&lt;div class="image01">&lt;/div>
// 							&lt;div class="image02">&lt;/div>
// 						&lt;/div>
// 						&lt;div id="foglayer_02" class="fog">
// 							&lt;div class="image01">&lt;/div>
// 							&lt;div class="image02">&lt;/div>
// 						&lt;/div>
// 						&lt;div id="foglayer_03" class="fog">
// 							&lt;div class="image01">&lt;/div>
// 							&lt;div class="image02">&lt;/div>
// 						&lt;/div>`;
// 	tarotDiv.append(fog);
// 	document.body.style.backgroundColor = "black";
// }

/**
 * Removes the fog background from the tarot card page
 * @date 5/31/2023
 */
function removeFogBackground() {
	const fogWrapper = document.getElementsByClassName("fogwrapper")[0];
	if (fogWrapper) {
		fogWrapper.remove();
	}
}

/**
 * Binds functionality to the burger bar.
 * @author Jason Bui
 * @date 5/26/2023
 */
/* function bindBurgerBar() {
	document.querySelector(".nav-toggle").addEventListener("click", () => {
		const navLinks = document.querySelector(".nav-links");
		navLinks.hidden = !navLinks.hidden;
	});
}*/

/**
 * Initializes home page
 */
function init() {
	createShuffleCards();
	displayGeneralUIElements();
	bindGeneralButtons();
	bindStartButton();
	bindResetButton();
}

/**
 * Binds the reset button to the reset function
 * @date 6/6/2023 - 3:57:05 PM
 * @author Victor Kim
 */
function bindResetButton() {
	const resetBtn = document.getElementById("tarotResetBtn");
	resetBtn.addEventListener("click", reset);
}

/**
 * Resets the tarot card flow
 * @date 6/6/2023 - 3:42:41 PM
 * @author Victor Kim
 */
function reset() {
	// TODO make an animation for this
	resetFlag = true;
	// reset cards
	resetCards();
	// hide and unhide buttons
	const startBtn = document.getElementById("tarotStartBtn");
	const resetBtn = document.getElementById("tarotResetBtn");
	startBtn.hidden = false;
	resetBtn.hidden = true;
	// stop animations
	Animator.instance.clearAllAnimations();
	// hide cards
	const cards = TarotCard.getAllCards();
	cards.forEach((card) => {
		card.cardElement.hidden = true;
	});
}

init();

/**
 * Hamburger bar closes when you hover off of it
 * @author Kyle Ng
 * @date 6/5/2023
 */
document.querySelector(".menu__box").addEventListener("mouseleave", function() {
	document.querySelector("#menu__toggle").checked = false;
});

document.addEventListener("DOMContentLoaded", function() {
	const menuToggle = document.querySelector("#menu__toggle");
	if (menuToggle) {
		menuToggle.addEventListener("change", () => {
			const menuItems = document.querySelectorAll(".menu__item");
			menuItems.forEach((item) => {
				item.hidden = !item.hidden;
			});
		});
	}
});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="global.html#Animator">Animator</a></li><li><a href="global.html#TarotCard">TarotCard</a></li></ul><h3>Global</h3><ul><li><a href="global.html#HOMEPAGE">HOMEPAGE</a></li><li><a href="global.html#allHidden">allHidden</a></li><li><a href="global.html#bindGeneralButtons">bindGeneralButtons</a></li><li><a href="global.html#bindHomePageBtns">bindHomePageBtns</a></li><li><a href="global.html#bindResetButton">bindResetButton</a></li><li><a href="global.html#bindShuffleButton">bindShuffleButton</a></li><li><a href="global.html#bindStartButton">bindStartButton</a></li><li><a href="global.html#createShuffleCards">createShuffleCards</a></li><li><a href="global.html#delay">delay</a></li><li><a href="global.html#displayGeneralUIElements">displayGeneralUIElements</a></li><li><a href="global.html#displayThreeOptions">displayThreeOptions</a></li><li><a href="global.html#getBGColor">getBGColor</a></li><li><a href="global.html#getHiddenVal">getHiddenVal</a></li><li><a href="global.html#getLeftVal">getLeftVal</a></li><li><a href="global.html#getMultipleInts">getMultipleInts</a></li><li><a href="global.html#getRandomInt">getRandomInt</a></li><li><a href="global.html#getSelectedValue">getSelectedValue</a></li><li><a href="global.html#init">init</a></li><li><a href="global.html#initializeServiceWorker">initializeServiceWorker</a></li><li><a href="global.html#playCardSpreadAnimation">playCardSpreadAnimation</a></li><li><a href="global.html#playCardThrowAnimation">playCardThrowAnimation</a></li><li><a href="global.html#playShuffleAnimation">playShuffleAnimation</a></li><li><a href="global.html#removeFogBackground">removeFogBackground</a></li><li><a href="global.html#reset">reset</a></li><li><a href="global.html#resetCards">resetCards</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.2</a> on Tue Jun 06 2023 23:26:51 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
